<!doctype html>
<html>
	<head>
    <link rel='shortcut icon' href='https://amicitia.github.io/images/favicon.png' type='image/x-icon' />
    <meta charset="utf-8"><title>Amicitia - Hookingfunctions</title><script src="https://amicitia.github.io/js/jquery-3.3.1.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/4c3075832a.js" crossorigin="anonymous"></script>
<script data-ad-client="ca-pub-9519592525056753" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link href="https://amicitia.github.io/favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="https://amicitia.github.io/css/amicitia.css" rel="stylesheet" type="text/css">
<script src="https://amicitia.github.io/js/bubbles.js"></script>
<script src="https://amicitia.github.io/js/clipboard.js"></script>
<script src="https://amicitia.github.io/js/showhide.js"></script>
<script src="https://amicitia.github.io/js/navigation.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/FeedEk.min.js"></script>
<script type="text/javascript" src="https://amicitia.github.io/js/jscolor.js"></script>
<link rel="stylesheet" href="https://amicitia.github.io/css/css3menu.css" type="text/css" />
<style type="text/css">._css3m {display: none;}</style></head><body style="background: linear-gradient(120deg, var(--gradient1) 0%, var(--gradient2) 100%) fixed;">
    <!--Copied Message-->
    <div class="copied">Copied to Clipboard</div>
    <div class="flex">
        <!--TopRow-->
        <div class="row top">
            <!--Navbar-->
            <div class="navbar">
                <input type="checkbox" id="css3menu-switcher" class="c3m-switch-input">
                <ul id="css3menu0" class="topmenu">
                    <li class="switch"><label onclick="" for="css3menu-switcher"></label></li>
                    <li class="topmenu"><a href="https://shrinefox.com" style="height:37px;line-height:37px;"><i class="fa fa-home" aria-hidden="true"></i> Home</a></li>
                    <li class="toproot">
                        <a style="height:37px;line-height:37px;"><span><i class="fa fa-cube" aria-hidden="true"></i> Resources <i class="fas fa-chevron-down" style="font-size: 6pt;"></i></span></a>
                        <ul>
                            <li><a href="https://amicitia.github.io"><i class="fa fa-download" aria-hidden="true"></i> Browse Mods & Tools</a></li>
                            <li><a href="https://shrinefox.com/PatchCreator"><i class="fa fa-check-square" aria-hidden="true"></i> RPCS3 Patch Creator</a></li>
                            <li><a href="https://shrinefox.com/UpdateCreator"><i class="fa fa-check-square" aria-hidden="true"></i> PS4 Patch Creator</a></li>
                            <li><a href="https://shrinefox.com/textsearch"><i class="fab fa-searchengin" aria-hidden="true"></i> Text Search</a></li>
                            <li><a href="https://amicitia.github.io/files"><i class="fa fa-folder-open" aria-hidden="true"></i> Files</a></li>
                            <li><a href="https://amicitia.github.io/docs/flowscript"><i class="fa fa-file-code" aria-hidden="true"></i> Flowscript Docs</a></li>
                        </ul>
                    </li>
                    <li class="toproot">
                        <a style="height:37px;line-height:37px;"><span><i class="fa fa-users" aria-hidden="true"></i> Community <i class="fas fa-chevron-down" style="font-size: 6pt;"></i></span></a>
                        <ul>
                            <li><a href="https://shrinefox.com/forum"><i class="fa fa-comments" aria-hidden="true"></i> Forum</a></li>
                            <li><a href="https://shrinefox.com/wiki"><i class="fa fa-book" aria-hidden="true"></i> Wiki</a></li>
                            <li><a href="https://discord.gg/9USHGmB"><i class="fab fa-discord" aria-hidden="true"></i> Discord</a></li>
                        </ul>
                    </li>
                    <li class="toproot" style="margin-left: 10px; position: relative;">
                        <a id="sidebartoggle" style="height:20px;"><span><i class="fa fa-user-circle"></i> Profile <i class="fas fa-chevron-down" style="font-size: 6pt;"></i></span></a>
                        <ul style="padding: 0 !important; -webkit-box-shadow: none !important; box-shadow: none !important; ">
                            <div>
                                <div class="sidebar">
                                    <div class="component">
                                        <div class="contents">
                                            <!--Notifications-->
                                            <li>
                                                <a href="https://shrinefox.com/forum/ucp.php">
                                                    <div class="item">
                                                        <i class="fa fa-address-card"></i> &nbsp;Account Settings
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="https://shrinefox.com/forum/ucp.php?i=pm&folder=inbox">
                                                    <div class="item">
                                                        <i class="fa fa-envelope"></i> &nbsp;Inbox
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="https://shrinefox.com/forum/search.php">
                                                    <div class="item">
                                                        <i class="fa fa-search"></i> &nbsp;Search
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="https://shrinefox.com/forum/search.php?search_id=egosearch">
                                                    <div class="item">
                                                        <i class="fa fa-sticky-note"></i> &nbsp;Your Posts
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="https://shrinefox.com/forum/search.php?search_id=active_topics">
                                                    <div class="item">
                                                        <i class="fa fa-star"></i> &nbsp;Active Threads
                                                    </div>
                                                </a>
                                            </li>
                                        </div> <!--End Contents-->
                                    </div> <!--End Component-->
                                </div> <!--End Sidebar-->
                            </div>
                        </ul>
                    </li>
                    <li class="toproot">
                        <a style="height:37px;line-height:37px;"><span><i class="fa fa-question-circle" aria-hidden="true"></i> About <i class="fas fa-chevron-down" style="font-size: 6pt;"></i></span></a>
                        <ul>
                            <li><a href="https://shrinefox.com/forum/app.php/faqpage"><i class="fa fa-comment-dots" aria-hidden="true"></i> FAQs</a></li>
                            <li><a href="https://shrinefox.com/about"><i class="fa fa-address-book" aria-hidden="true"></i> Credits</a></li>
                            <li><a href="https://youtube.com/c/ShrineFox"><i class="fab fa-youtube" aria-hidden="true"></i> YouTube</a></li>
                            <li><a href="https://twitter.com/AmicitiaTeam"><i class="fab fa-twitter" aria-hidden="true"></i> Twitter</a></li>
                        </ul>
                    </li>
                    <li class="toproot">
                        <a style="height:37px;line-height:37px;"><span><i class="fa fa-newspaper" aria-hidden="true"></i> Articles <i class="fas fa-chevron-down" style="font-size: 6pt;"></i></span></a>
                        <ul>
                            <li><a href="https://shrinefox.com/news"><i class="fa fa-newspaper" aria-hidden="true"></i> News</a></li>
                            <li><a href="https://shrinefox.com/guides"><i class="fa fa-graduation-cap" aria-hidden="true"></i> Guides</a></li>
                            <li><a href="https://shrinefox.com"><i class="fab fa-wordpress" aria-hidden="true"></i> Blog</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!--Header-->
            <div class="header">
                <canvas id="bgCanvas" width="715" height="722" style=""></canvas>
                <div class="header-inner">
                    <!--Title--><center><a href="https://amicitia.github.io"><img src="https://amicitia.github.io/images/logo.svg" style="width:150px;height:150px;"><h1>Flowscript Docs</h1><h2>Hookingfunctions</h2></a></center>            <!--Waves-->
    <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
            <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
        </defs>
        <g class="parallax">
            <use xlink:href="#gentle-wave" x="48" y="0"></use>
            <use xlink:href="#gentle-wave" x="48" y="3"></use>
            <use xlink:href="#gentle-wave" x="48" y="5"></use>
            <use xlink:href="#gentle-wave" x="48" y="7"></use>
        </g>
    </svg>
</div>
<!--Waves End-->
<!--Header End-->
    </div>
<!--Navbar End-->
</div>
<!--Top End-->
<!--Middle-->
<div class="row middle">
    <!--Page Body-->
    <div class="content">
        <div class="wrap">
            <!--Main Page Content-->
            <table id="wrap">
                <tr>
                    <td style="vertical-align:top;">
                        <b><a href="https://shrinefox.com/"><i class="fa fa-home" aria-hidden="true"></i> ShrineFox.com</a> > Resources > <a href="https://amicitia.github.io">Browse Mods & Tools</a> > Flowscript Docs > Hookingfunctions</b><br><br><table>
    <tr>
        <td width="25%" style="vertical-align:top">
            Basics
            <br>↳ <a href="https://amicitia.github.io/docs/flowscript">Flowscript</a>
            <br>↳ <a href="https://amicitia.github.io/docs/messagescript">Messagescript</a>
            <br>↳ <a href="https://amicitia.github.io/docs/decompiling">Decompiling</a>
            <br>↳ <a href="https://amicitia.github.io/docs/compiling">Compiling</a>
            <br>
            <br>Features
            <br>↳ <a href="https://amicitia.github.io/docs/importing">Importing</a>
            <br>↳ Declaring Functions
            <br>↳ Declaring Variables
            <br>↳ <a href="https://amicitia.github.io/docs/hookingfunctions">Hooking Functions</a>
            <br>
            <br>P5 Functions
            <br>↳ AI
            <br>↳ Common
            <br>↳ Facility
            <br>↳ Field
            <br>↳ Net
            <br>↳ Social
        </td>
        <td style="width: 75%; vertical-align: top;">
<h1>Hooking Functions</h1>
						AtlusScriptCompiler is not perfect, and sometimes decompiled data is imprecise (usually float values). This can lead to glitches (weird camera/player positioning and movement) and even crashes in-game when a recompiled script is modded back in.
<br />To get around this, AtlusScriptCompiler has a feature that preserves the original .BF's data, appending only new data to the end from your compiled .FLOW.
<br />You can use this to <b>replace the contents of a specific method or function</b> without screwing up the rest of the file.
<h2>Creating the .FLOW</h2>
						In this example, let's say we wanted to replace ONLY the contents of <b>fld_square_menu</b>, a method in <b>field.bf</b>.
<br />We would have to create a new text document ending with the .FLOW extension, named anything we want. In this example, <b>fieldhook.flow</b>.
<h2>Referencing the .BF</h2>
						In that blank document, let's import the bf. Make sure the .flow is in the same directory as the .bf and <a href="https://amicitia.github.io/docs/importing">follow the instructions from the importing guide</a>, like so:
<pre><code>import( "field.bf" );</code></pre>
<h2>Creating the Hook</h2>
						Next, let's copy the method we want to replace from the decompiled .bf, changing whatever we want. You can even reference external methods you add to your .flow like so:
<pre><code>
import( "field.bf" );

void fld_square_menu_hook()
{
    ModMenuDisplay();
}

void ModMenuDisplay()
{
    ALL_ENABLE_SHARE_PLAY(); //Re-enables screen recording
    BIT_OFF( 4099 ); //Removes your "tired" status
...
</code></pre>
						Note that the replacement method has "_hook" appended to the name. This is important.
<h2>Compiling the .FLOW</h2>
						Follow the same steps as the <a href="https://amicitia.github.io/docs/compiling">Compiling guide</a>, except add one extra commandline argument: "-Hook".
<br />For example:
<br /><pre><code>AtlusScriptCompiler.exe fieldhook.flow -Compile -OutFormat V3BE -Library P5 -Encoding P5 -Hook</code></pre>
<br />This should generate fieldhook.bf, an identical copy of field.bf except with the <b>ModMenuDisplay()</b> method replacing the contents of <b>fld_square_menu_hook</b>.
			</td>
		</tr>
	</table>								<!--Pagination-->
                                </td>
							</tr>
						</table>
					</div>
                </td></tr></tbody></table>
                <!--Footer-->
                <div class="row bottom">
                    <footer>
                        <table style="padding-right: 2%;">
                            <tbody>
                                <tr>
                                    <td id="about_site" style="vertical-align: top;width: 25%;">
                                        <center>
                                            <div class="amicitia-logo" style="left: auto;position: relative;width: 75px;height: 75px;float: none;">
                                                <div class="amicitia-svg" style="height: 75px; width: 75px;background: url(https://amicitia.github.io/images/logo.svg) center center/75px no-repeat;"></div>
                                            </div>
                                        </center>
                                        <br>
                                        <a href="https://shrinefox.com/amicitia">Amicitia</a> is a modding network dedicated to documenting & reverse engineering SMT/Persona games, named after <a href="https://github.com/TGEnigma">TGEnigma</a>'s all-in-one editor application <a href="https://amicitia.github.io/post/amicitia">of the same name</a>.
                                    </td>
                                    <td id="site_disclaimer" width="5%" style="vertical-align:top;"></td>
                                    <td>
                                        We are NOT affiliated, associated, authorized, endorsed by, or in any way
                                        officially connected with ATLUS, SEGA, or any of its subsidiaries or its affiliates.
                                        The official ATLUS website can be found at <a href="https://atlus.com/">https://atlus.com</a>. ATLUS and SEGA are
                                        registered in the U.S. Patent and Trademark Office. ATLUS, SHIN MEGAMI TENSEI, and PERSONA are
                                        either registered trademarks or trademarks of ATLUS Co., Ltd. or its affiliates.
                                        <!--Theme Select required for bubbles.js themeing-->
                                        <table id="settings">
                                            <tr>
                                                <td style="vertical-align:top;">
                                                    <br><br>Theme: <select id="theme" name="theme" onchange="ThemeToggle()">
                                                        <option value="" selected>Default</option>
                                                        <option value="p5">Red/Black</option>
                                                        <option value="p4">Yellow/Orange</option>
                                                        <option value="p3fes">Green/Black</option>
                                                        <option value="pq">Pink/Purple</option>
                                                        <option value="custom">Custom</option>
                                                    </select>

                                                    <!--Color Picker-->
                                                    <script>
                                                        jscolor.presets.default = {
                                                            format: 'rgb', previewSize: 20, paletteCols: 1,
                                                            backgroundColor: 'rgb(var(--post))', borderColor: 'rgb(var(--post))',
                                                            padding: 5, width: 100, height: 100, mode: 'HVS',
                                                            controlBorderColor: 'rgb(var(--post))', sliderSize: 8, shadow: false
                                                        };
                                                    </script>
                                                    <div id="colorpicker" style="display:none;">
                                                        <div class="toggle">
                                                            <div class="toggle-title" style="cursor: pointer;" onclick="updateColorPicker()">
                                                                <a><i class="fa fa-gears"></i> Theme Settings</a>
                                                            </div>
                                                            <div class="toggle-inner">
                                                                <br><button id="customlink" data-jscolor="{onChange: 'updateLink(this)',value:'rgb(var(--link))', alpha:1}">Link</button>
                                                                <br><button id="customhover" data-jscolor="{onChange: 'updateHover(this)',value:'rgb(var(--hover))', alpha:1}">Hover</button>
                                                                <br><button id="custombg" data-jscolor="{onChange: 'updateBg(this)',value:'rgb(var(--bg))', alpha:1}">Background</button>
                                                                <br><button id="custombg2" data-jscolor="{onChange: 'updateBg2(this)',value:'rgb(var(--bg2))', alpha:1}">Background 2</button>
                                                                <br><button id="customtext" data-jscolor="{onChange: 'updateText(this)',value:'rgb(var(--text))', alpha:1}">Text</button>
                                                                <br><button id="custompost" data-jscolor="{onChange: 'updatePost(this)',value:'rgb(var(--post))', alpha:1}">Post</button>
                                                                <br><button id="customtextinner" data-jscolor="{onChange: 'updateTextinner(this)',value:'rgb(var(--textinner))', alpha:1}">Inner Text</button>
                                                                <br><button id="customfooter" data-jscolor="{onChange: 'updateFooter(this)',value:'rgb(var(--footer))', alpha:1}">Footer</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="vertical-align:top;">
                                                    <!--Bubble Popping SFX Toggle-->
                                                    <br>Sound: <i id="sound" class="fas fa-volume-mute" onclick="SoundToggle()"></i>
                                                    <!--Performance Mode Toggle-->
                                                    <br>Performance Mode: <i id="performance" class="fas fa-toggle-off" onclick="PerformanceToggle()"></i>
                                                    <!--Score Display-->
                                                    <br><span id="score">0</span> bubbles popped
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                            </tbody>
                        </table>
                        <br>
                        <center>
                            <!--AdSense-->
                            <br>
                            <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-hx+4+s-4m+70" data-ad-client="ca-pub-9519592525056753" data-ad-slot="8263745709"></ins>
                            <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
                            <br>
                            <!--Credits-->
                            <br>© ShrineFox 2020 - 2021. <a href="https://ko-fi.com/shrinefox"><i class="fa fa-coffee"></i> Support</a>
                            <br><br>
                            <!--Placeholder-->
                            <select id="game" name="game" style="display:none;">
                                <option value="" selected>Default</option>
                            </select>
                        </center>
                        <!--End Footer-->
                    </footer>
                </div>
                <!--End Bottom-->
		     </div>
		</form>
	</body>
</html>